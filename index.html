<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LPIC Penguin Rescue</title>
    <style>
        :root {
            --sky-blue: #87ceeb;
            --ice-white: #f0f8ff;
            --term-green: #00ff41;
            --error-red: #ff4757;
            --ocean-blue: #1e3799;
        }

        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', 'Hiragino Kaku Gothic ProN', sans-serif;
            background-color: var(--sky-blue);
        }

        /* --- ËÉåÊôØ„Éª„É¨„Ç§„Ç¢„Ç¶„Éà --- */
        #world {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        #sky {
            flex: 2;
            position: relative;
            background: linear-gradient(to bottom, #2980b9, #6dd5fa);
            overflow: hidden;
        }

        #typing-area {
            flex: 3;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        #ground {
            flex: 2;
            background: linear-gradient(to bottom, #fff 0%, var(--ice-white) 100%);
            position: relative;
            border-top: 5px solid #dff9fb;
        }

        /* --- Èõ≤„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ --- */
        .cloud {
            position: absolute;
            background: #fff;
            width: 100px; height: 40px;
            border-radius: 50px;
            opacity: 0.8;
            animation: moveCloud linear infinite;
        }
        @keyframes moveCloud {
            from { transform: translateX(110vw); }
            to { transform: translateX(-20vw); }
        }

        /* --- „Çø„Ç§„Éî„É≥„Ç∞UI --- */
        #cmd-display {
            background: rgba(0, 0, 0, 0.7);
            padding: 30px;
            border-radius: 20px;
            border: 4px solid #fff;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center;
            max-width: 80%;
        }

        #target-desc { color: #ecf0f1; font-size: 1.2rem; margin-bottom: 10px; }
        #target-text { font-family: 'Consolas', monospace; font-size: 2.5rem; color: #fff; letter-spacing: 2px; }
        .correct { color: var(--term-green); text-shadow: 0 0 10px var(--term-green); }
        .current { border-bottom: 3px solid #fff; }

        /* --- „Éö„É≥„ÇÆ„É≥„Å®Á©¥ --- */
        #penguin {
            position: absolute;
            bottom: 40px;
            left: 10%;
            font-size: 5rem;
            z-index: 20;
            transition: left 0.1s linear, transform 0.2s;
        }

        #pit {
            position: absolute;
            right: 0;
            bottom: 0;
            width: 15%;
            height: 100%;
            background: var(--ocean-blue);
            clip-path: polygon(20% 0, 100% 0, 100% 100%, 0% 100%);
        }

        #pit-label {
            position: absolute;
            right: 20px;
            bottom: 50px;
            color: #fff;
            font-weight: bold;
            font-size: 1.5rem;
        }

        /* --- „Ç™„Éº„Éê„Éº„É¨„Ç§ --- */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: white;
        }

        button {
            padding: 20px 60px;
            font-size: 2rem;
            background: var(--term-green);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #009432;
        }
        button:active { transform: translateY(5px); box-shadow: none; }

        .miss-flash { animation: flash 0.1s; }
        @keyframes flash {
            from { background-color: var(--error-red); }
            to { background-color: transparent; }
        }
    </style>
</head>
<body onclick="initAudio()">

<div id="world">
    <div id="sky">
        <div class="cloud" style="top: 20%; animation-duration: 25s;"></div>
        <div class="cloud" style="top: 50%; animation-duration: 40s; width: 150px;"></div>
    </div>
    
    <div id="typing-area">
        <div id="cmd-display">
            <div id="target-desc">PRESS START</div>
            <div id="target-text">LPIC RESCUE</div>
        </div>
    </div>

    <div id="ground">
        <div id="penguin">üêß</div>
        <div id="pit"></div>
        <div id="pit-label">ËêΩ„Å®„ÅóÁ©¥ÔºÅ</div>
    </div>
</div>

<div id="start-screen" class="overlay">
    <h1 style="font-size: 4rem;">üêß „Éö„É≥„ÇÆ„É≥ÊïëÂá∫‰ΩúÊà¶</h1>
    <p style="font-size: 1.5rem; margin-bottom: 30px;">Á©¥„Å´ËêΩ„Å°„ÇãÂâç„Å´„Ç≥„Éû„É≥„Éâ„ÇíÊâì„Å°Ëæº„ÇÅÔºÅ</p>
    <button onclick="startGame()">„É¨„Çπ„Ç≠„É•„ÉºÈñãÂßã (Enter)</button>
</div>

<div id="result-screen" class="overlay" style="display: none;">
    <h2 id="result-title" style="font-size: 3rem;">FINISH!</h2>
    <div id="stats" style="font-size: 1.5rem; margin: 30px; text-align: center;"></div>
    <button onclick="location.reload()">ÂÜçÊåëÊà¶</button>
</div>

<script>
    // --- ÂïèÈ°å„Éá„Éº„Çø ---
    const questions = [
        { cmd: "ls -la", desc: "Èö†„Åó„Éï„Ç°„Ç§„É´„ÇíÂê´„ÇÄË©≥Á¥∞Ë°®Á§∫" },
        { cmd: "ls -ltr", desc: "Âè§„ÅÑÈ†Ü„Å´Ë°®Á§∫" },
        { cmd: "cp -rp src/ dest/", desc: "Â±ûÊÄß‰øùÊåÅ„Ç≥„Éî„Éº" },
        { cmd: "rm -rf /tmp/old", desc: "Âº∑Âà∂„Éá„Ç£„É¨„ÇØ„Éà„É™ÂâäÈô§" },
        { cmd: "mkdir -p /a/b/c", desc: "ÈöéÂ±§„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê" },
        { cmd: "chmod 755 script", desc: "ÂÆüË°åÊ®©Èôê‰ªò‰∏é" },
        { cmd: "chown root:root file", desc: "ÊâÄÊúâËÄÖÂ§âÊõ¥" },
        { cmd: "grep -i 'error' file", desc: "Â§ßÊñáÂ≠óÂ∞èÊñáÂ≠óÁÑ°Ë¶ñÊ§úÁ¥¢" },
        { cmd: "systemctl start sshd", desc: "SSHËµ∑Âãï" },
        { cmd: "df -h", desc: "„Éá„Ç£„Çπ„ÇØÂÆπÈáèË°®Á§∫" },
        { cmd: "ip addr show", desc: "IPÁ¢∫Ë™ç" },
        { cmd: "tail -f /var/log", desc: "„É≠„Ç∞„É™„Ç¢„É´„Çø„Ç§„É†Áõ£Ë¶ñ" },
        { cmd: "apt update && apt upgrade", desc: "„Éë„ÉÉ„Ç±„Éº„Ç∏Êõ¥Êñ∞" },
        { cmd: "/etc/shadow", desc: "„Éë„Çπ„ÉØ„Éº„Éâ‰øùÂ≠ò„Éï„Ç°„Ç§„É´" }
    ];

    let currentQ, typedIndex, score, timeLeft, gameActive;
    let penguinPos = 10;
    let currentSpeed = 0; // „Åù„ÅÆÂïèÈ°å„ÅÆÁßªÂãïÈÄüÂ∫¶
    let audioCtx = null;

    function initAudio() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }

    function playSound(freq, type, duration) {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        gameActive = true;
        score = 0;
        timeLeft = 60;
        nextQuestion();
        gameLoop();
        
        const timer = setInterval(() => {
            if(gameActive) timeLeft--;
            if(timeLeft <= 0) {
                clearInterval(timer);
                endGame();
            }
        }, 1000);
    }

    function nextQuestion() {
        currentQ = questions[Math.floor(Math.random() * questions.length)];
        typedIndex = 0;
        penguinPos = 10; 

        // --- „Äê‰ªäÂõû„ÅÆËÇù„ÄëÈÄüÂ∫¶„ÅÆÂãïÁöÑË®àÁÆó ---
        // 10%„Åã„Çâ85%„Åæ„ÅßÔºàË∑ùÈõ¢75%Ôºâ„Çí„ÄÅ1ÁßíÈñì„Å´2ÊñáÂ≠ó„ÅÆ„Éö„Éº„Çπ„ÅßÈÄ≤„ÇÄË®≠ÂÆö
        const targetCPS = 0.5; // 1Áßí„ÅÇ„Åü„Çä„ÅÆ„Ç≠„ÉºÊï∞Ôºà0.5„Ç≠„Éº/ÁßíÔºâ
        const timeLimit = currentQ.cmd.length / targetCPS; // Áå∂‰∫àÁßíÊï∞
        // 1„Éï„É¨„Éº„É†(1/60Áßí)„ÅÇ„Åü„Çä„ÅÆÁßªÂãïÈáè„ÇíÁÆóÂá∫
        currentSpeed = (75 / timeLimit) / 60;

        updateDisplay();
    }

    function updateDisplay() {
        let html = "";
        for (let i = 0; i < currentQ.cmd.length; i++) {
            if (i < typedIndex) html += `<span class="correct">${currentQ.cmd[i]}</span>`;
            else if (i === typedIndex) html += `<span class="current">${currentQ.cmd[i]}</span>`;
            else html += `<span>${currentQ.cmd[i]}</span>`;
        }
        document.getElementById('target-text').innerHTML = html;
        document.getElementById('target-desc').innerText = currentQ.desc;
    }

    function gameLoop() {
        if (!gameActive) return;

        // Ë®àÁÆó„Åï„Çå„Åü‰∏ÄÂÆöÈÄüÂ∫¶„ÅßÈÄ≤„ÇÄÔºàÊäº„ÅóÊàª„Åó„Å™„ÅóÔºâ
        penguinPos += currentSpeed;
        document.getElementById('penguin').style.left = penguinPos + "%";

        if (penguinPos > 85) {
            playSound(150, 'sawtooth', 0.3);
            penguinPos = 10;
            score = Math.max(0, score - 50);
            nextQuestion();
        }

        requestAnimationFrame(gameLoop);
    }

    window.addEventListener('keydown', (e) => {
        if (!gameActive) {
            if (e.key === 'Enter') startGame();
            return;
        }

        if (e.key.length > 1) return;

        if (e.key === currentQ.cmd[typedIndex]) {
            typedIndex++;
            playSound(600, 'sine', 0.05);
            if (typedIndex >= currentQ.cmd.length) {
                score += 100;
                playSound(1000, 'sine', 0.1);
                
                // „Ç∏„É£„É≥„ÉóÊºîÂá∫
                const p = document.getElementById('penguin');
                p.style.transform = 'translateY(-50px) rotate(360deg)';
                setTimeout(() => {
                    p.style.transform = 'translateY(0) rotate(0)';
                    nextQuestion();
                }, 200);
            } else {
                updateDisplay();
            }
        } else {
            playSound(200, 'square', 0.1);
            document.body.classList.add('miss-flash');
            setTimeout(() => document.body.classList.remove('miss-flash'), 100);
        }
    });

    function endGame() {
        gameActive = false;
        document.getElementById('result-screen').style.display = 'flex';
        document.getElementById('stats').innerHTML = `„Çπ„Ç≥„Ç¢: ${score}ÁÇπ<br>LPIC„É¨„Éô„É´: ${score > 1500 ? 'rootÁ¥ö' : '‰∏ÄËà¨„É¶„Éº„Ç∂„ÉºÁ¥ö'}`;
    }
</script>
</body>
</html>




